# Use a slim Node.js image to keep the container lightweight
FROM node:18-slim

# Set the working directory inside the container
WORKDIR /app

# Copy package files first to leverage Docker layer caching
COPY package*.json ./

# Install production dependencies only
RUN npm install --only=production

# Copy the rest of the source code (specifically src/)
COPY . .

# Cloud Run injects the PORT environment variable.
# We document that the app listens on 8080.
EXPOSE 8080

# Use 'node' to start the application directly
CMD [ "node", "src/index.js" ]
